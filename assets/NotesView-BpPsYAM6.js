import{d as $,c as r,o as s,a as l,t as f,b,I as A,_ as w,F as D,r as F,e as k,f as p,u as U,w as L,g as m,h as V,i as j,j as T,B as x,k as C,l as O,m as M,n as P}from"./index-9XF5fugI.js";const q={class:"note","aria-labelledby":"note-title"},z={class:"note__header"},G={class:"note__header--title"},H={class:"note__content"},J={class:"note__content--text"},K={class:"note__content--btn-wrapper"},Q=$({__name:"NoteCard",props:{title:{},content:{}},emits:["delete"],setup(g){return(e,i)=>(s(),r("article",q,[l("div",z,[l("h4",G,f(e.title),1)]),l("div",H,[l("div",J,f(e.content),1),l("div",K,[b(A,{class:"note__content--icon"}),l("button",{class:"note__content--btn",onClick:i[0]||(i[0]=a=>e.$emit("delete")),"aria-label":"Удалить заметку"}," Удалить ")])])]))}}),R=w(Q,[["__scopeId","data-v-3cca98b4"]]),W={class:"note-card-list","aria-label":"Список заметок"},X=$({__name:"NoteList",props:{notes:{}},emits:["delete"],setup(g){return(e,i)=>(s(),r("div",W,[(s(!0),r(D,null,F(e.notes,a=>(s(),k(R,{key:a.id,title:a.title,content:a.content,onDelete:t=>e.$emit("delete",a.id)},null,8,["title","content","onDelete"]))),128))]))}}),Y=w(X,[["__scopeId","data-v-a1299ddb"]]),Z={},ee={xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none"};function te(g,e){return s(),r("svg",ee,e[0]||(e[0]=[l("path",{stroke:"#fff","stroke-linecap":"round","stroke-width":"2",d:"M1 9h16M9 1v16"},null,-1)]))}const ae=w(Z,[["render",te]]),y={modalUuid:"modal::add-note"};class se{static validate(e,i){const a=[];return e.trim()||a.push({field:"title",message:"Заголовок обязателен"}),i.trim()||a.push({field:"content",message:"Текст заметки не может быть пустым"}),a}}const oe={class:"input"},le={key:0,class:"input__label"},ne={class:"input__container input__container--textarea"},re=["placeholder","value","rows","cols"],ie=$({__name:"TextareaUI",props:{label:{},placeholder:{},modelValue:{},rows:{default:4},cols:{default:50}},emits:["update:modelValue"],setup(g,{emit:e}){const i=e,a=t=>{const n=t.target;i("update:modelValue",n.value)};return(t,n)=>(s(),r("div",oe,[t.label?(s(),r("label",le,f(t.label),1)):p("",!0),l("div",ne,[l("textarea",{class:"input__field input__field--textarea",placeholder:t.placeholder,value:t.modelValue,rows:t.rows,cols:t.cols,onInput:a},null,40,re)])]))}}),ce=w(ie,[["__scopeId","data-v-cc6418c5"]]),de={class:"form-group"},ue={key:0,id:"title-error",class:"sr-only"},_e={class:"form-group"},ve={key:0,id:"content-error",class:"sr-only"},me={class:"actions-group"},pe={key:0,class:"error-message",role:"alert","aria-live":"assertive"},he=$({__name:"AddNoteModal",emits:["success"],setup(g,{emit:e}){const i=e,a=M(),t=U(),n=t.getState(y.modalUuid);L(n,v=>{v||S()});const c=m(""),_=m(""),d=m({email:"",password:"",confirmPassword:""}),u=m(""),o=m(!1),B=()=>{d.value={title:"",content:""};const v=se.validate(c.value,_.value);return v.forEach(h=>{d.value[h.field]=h.message}),v.length===0},E=()=>{t.close(y.modalUuid)},I=async()=>{if(!B()||o.value)return;o.value=!0;const v=await a.createNote({title:c.value,content:_.value});if(o.value=!1,v.error){u.value=v.error.messages.join(", ");return}i("success"),E()},S=()=>{c.value="",_.value="",u.value="",o.value=!1};return(v,h)=>(s(),k(T,{"modal-id":j(y).modalUuid,header:"Добавление заметки",onClose:S,role:"dialog","aria-labelledby":"modal-title","aria-describedby":"modal-description"},{content:V(()=>[l("form",{onSubmit:O(I,["prevent"]),"aria-label":"Форма добавления заметки"},[l("div",de,[b(C,{"max-length":100,"value-length":c.value.length,"error-message":d.value.title,"show-error":!0,modelValue:c.value,"onUpdate:modelValue":h[0]||(h[0]=N=>c.value=N),type:"text",placeholder:"Введите заголовок",label:"Заголовок","aria-describedby":"title-error"},null,8,["value-length","error-message","modelValue"]),d.value.title?(s(),r("span",ue,f(d.value.title),1)):p("",!0)]),l("div",_e,[b(C,{component:ce,modelValue:_.value,"onUpdate:modelValue":h[1]||(h[1]=N=>_.value=N),"max-length":500,"value-length":_.value.length,"error-message":d.value.content,"show-error":!0,"is-textarea":!0,placeholder:"Введите содержание заметки",label:"Содержание","aria-describedby":"content-error"},null,8,["modelValue","value-length","error-message"]),d.value.content?(s(),r("span",ve,f(d.value.content),1)):p("",!0)])],32)]),actions:V(()=>[l("div",me,[b(x,{label:o.value?"Добавление...":"Добавить",disabled:o.value,onClick:I,"aria-label":"Добавить заметку"},null,8,["label","disabled"])]),u.value?(s(),r("div",pe,f(u.value),1)):p("",!0)]),_:1},8,["modal-id"]))}}),fe=w(he,[["__scopeId","data-v-78534b35"]]),ge={class:"container","aria-labelledby":"notes-heading"},be={key:0,class:"loading-state",role:"status","aria-live":"polite"},we={key:1,class:"error-state",role:"alert","aria-live":"assertive"},$e=$({__name:"NotesView",setup(g){const e=M(),i=U(),a=m([]),t=m(!1),n=m(null);P(()=>{c()});const c=async()=>{t.value=!0,n.value=null;const{data:u,error:o}=await e.getList();if(o){n.value=o.message;return}a.value=u||[],t.value=!1},_=()=>{i.open(y.modalUuid)},d=async u=>{const{error:o}=await e.deleteNote(u);if(o){n.value=o.message;return}await c()};return(u,o)=>(s(),r("main",ge,[o[0]||(o[0]=l("h1",{id:"notes-heading",class:"visually-hidden"},"Мои заметки",-1)),t.value&&!n.value?(s(),r("div",be," Загружаем заметки... ")):p("",!0),n.value?(s(),r("div",we," Ошибка: "+f(n.value),1)):p("",!0),!t.value&&!n.value?(s(),k(Y,{key:2,notes:a.value,onDelete:d,"aria-labelledby":"notes-heading"},null,8,["notes"])):p("",!0),!t.value&&!n.value?(s(),k(x,{key:3,class:"floating-button",onClick:_,"aria-label":"Добавить заметку"},{appendIcon:V(()=>[b(ae,{"aria-hidden":"true"})]),_:1})):p("",!0),b(fe,{onSuccess:c})]))}}),ke=w($e,[["__scopeId","data-v-e2525524"]]);export{ke as default};
