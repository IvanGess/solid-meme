import{d as $,c,o as l,a as o,t as w,b as g,I as A,_ as b,F as D,r as F,e as k,f,u as U,w as L,g as v,h as y,i as j,j as T,B as x,k as C,l as O,m as M,n as P}from"./index-Bh9-mLVA.js";const q={class:"note"},z={class:"note__header"},G={class:"note__header--title"},H={class:"note__content"},J={class:"note__content--text"},K={class:"note__content--btn-wrapper"},Q=$({__name:"NoteCard",props:{title:{},content:{}},emits:["delete"],setup(p){return(e,r)=>(l(),c("div",q,[o("div",z,[o("h4",G,w(e.title),1)]),o("div",H,[o("div",J,w(e.content),1),o("div",K,[g(A),o("button",{class:"note__content--btn",onClick:r[0]||(r[0]=s=>e.$emit("delete"))}," Удалить ")])])]))}}),R=b(Q,[["__scopeId","data-v-f6b29889"]]),W={class:"note-card-list"},X=$({__name:"NoteList",props:{notes:{}},emits:["delete"],setup(p){return(e,r)=>(l(),c("div",W,[(l(!0),c(D,null,F(e.notes,s=>(l(),k(R,{key:s.id,title:s.title,content:s.content,onDelete:t=>e.$emit("delete",s.id)},null,8,["title","content","onDelete"]))),128))]))}}),Y=b(X,[["__scopeId","data-v-73b01c25"]]),Z={},ee={xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none"};function te(p,e){return l(),c("svg",ee,e[0]||(e[0]=[o("path",{stroke:"#fff","stroke-linecap":"round","stroke-width":"2",d:"M1 9h16M9 1v16"},null,-1)]))}const se=b(Z,[["render",te]]),N={modalUuid:"modal::add-note"};class ae{static validate(e,r){const s=[];return e.trim()||s.push({field:"title",message:"Заголовок обязателен"}),r.trim()||s.push({field:"content",message:"Текст заметки не может быть пустым"}),s}}const oe={class:"input"},le={key:0,class:"input__label"},ne={class:"input__container input__container--textarea"},re=["placeholder","value","rows","cols"],ie=$({__name:"TextareaUI",props:{label:{},placeholder:{},modelValue:{},rows:{default:4},cols:{default:50}},emits:["update:modelValue"],setup(p,{emit:e}){const r=e,s=t=>{const n=t.target;r("update:modelValue",n.value)};return(t,n)=>(l(),c("div",oe,[t.label?(l(),c("label",le,w(t.label),1)):f("",!0),o("div",ne,[o("textarea",{class:"input__field input__field--textarea",placeholder:t.placeholder,value:t.modelValue,rows:t.rows,cols:t.cols,onInput:s},null,40,re)])]))}}),ce=b(ie,[["__scopeId","data-v-cc6418c5"]]),de={class:"form-group"},ue={class:"form-group"},_e={class:"actions-group"},ve={key:0,class:"error-message"},me=$({__name:"AddNoteModal",emits:["success"],setup(p,{emit:e}){const r=e,s=M(),t=U(),n=t.getState(N.modalUuid);L(n,_=>{_||S()});const i=v(""),u=v(""),h=v({email:"",password:"",confirmPassword:""}),d=v(""),a=v(!1),B=()=>{h.value={title:"",content:""};const _=ae.validate(i.value,u.value);return _.forEach(m=>{h.value[m.field]=m.message}),_.length===0},E=()=>{t.close(N.modalUuid)},I=async()=>{if(!B()||a.value)return;a.value=!0;const _=await s.createNote({title:i.value,content:u.value});if(a.value=!1,_.error){d.value=_.error.messages.join(", ");return}r("success"),E()},S=()=>{i.value="",u.value="",d.value="",a.value=!1};return(_,m)=>(l(),k(T,{"modal-id":j(N).modalUuid,header:"Добавление заметки",onClose:S},{content:y(()=>[o("form",{onSubmit:O(I,["prevent"])},[o("div",de,[g(C,{"max-length":100,"value-length":i.value.length,"error-message":h.value.title,"show-error":!0,modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=V=>i.value=V),type:"text",placeholder:"Введите заголовок",label:"Заголовок"},null,8,["value-length","error-message","modelValue"])]),o("div",ue,[g(C,{component:ce,modelValue:u.value,"onUpdate:modelValue":m[1]||(m[1]=V=>u.value=V),"max-length":500,"value-length":u.value.length,"error-message":h.value.content,"show-error":!0,"is-textarea":!0,placeholder:"Введите содержание заметки",label:"Содержание"},null,8,["modelValue","value-length","error-message"])])],32)]),actions:y(()=>[o("div",_e,[g(x,{label:a.value?"добавление...":"Добавить",disabled:a.value,onClick:I},null,8,["label","disabled"])]),d.value?(l(),c("div",ve,w(d.value),1)):f("",!0)]),_:1},8,["modal-id"]))}}),pe=b(me,[["__scopeId","data-v-ec2709f9"]]),he={class:"container","aria-labelledby":"notes-heading"},fe={key:0,class:"loading-state",role:"status","aria-live":"polite"},ge={key:1,class:"error-state",role:"alert","aria-live":"assertive"},be=$({__name:"NotesView",setup(p){const e=M(),r=U(),s=v([]),t=v(!1),n=v(null);P(()=>{i()});const i=async()=>{t.value=!0,n.value=null;const{data:d,error:a}=await e.getList();if(a){n.value=a.message;return}s.value=d||[],t.value=!1},u=()=>{r.open(N.modalUuid)},h=async d=>{const{error:a}=await e.deleteNote(d);if(a){n.value=a.message;return}await i()};return(d,a)=>(l(),c("main",he,[a[0]||(a[0]=o("h1",{id:"notes-heading",class:"visually-hidden"},"Мои заметки",-1)),t.value&&!n.value?(l(),c("div",fe," Загружаем заметки... ")):f("",!0),n.value?(l(),c("div",ge," Ошибка: "+w(n.value),1)):f("",!0),!t.value&&!n.value?(l(),k(Y,{key:2,notes:s.value,onDelete:h,"aria-labelledby":"notes-heading"},null,8,["notes"])):f("",!0),!t.value&&!n.value?(l(),k(x,{key:3,class:"floating-button",onClick:u,"aria-label":"Добавить заметку"},{appendIcon:y(()=>[g(se,{"aria-hidden":"true"})]),_:1})):f("",!0),g(pe,{onSuccess:i})]))}}),$e=b(be,[["__scopeId","data-v-2e12a88b"]]);export{$e as default};
